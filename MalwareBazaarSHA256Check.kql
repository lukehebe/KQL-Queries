let MalwareSampleSHA256 = externaldata(SHA256: string)[@"https://bazaar.abuse.ch/export/txt/sha256/recent"] with (format="txt", ignoreFirstRecord=True);
let SHA256Regex = '[a-f0-9]{64}';
let MaliciousSHA256 = materialize (
          MalwareSampleSHA256
          | where SHA256 matches regex SHA256Regex
          | distinct SHA256
          );
DeviceFileEvents
| where SHA256 has_any (MaliciousSHA256)
